library(ggpubr)
library(dplyr)
library(ggplot2)
library(detzrcr)
library(gcookbook)

data(heightweight)
heightweight
population = heightweight$heightIn
mu = mean(population); mu
sigma = sd(population); sigma

population = data.frame(heightweight)
sampl=sample_n(population,size = 50)
mean_sampl=sum(sampl$heightIn)/length(sampl$heightIn)
mean_sampl

z_star_95 <- qnorm(0.975)
lower = mean_sampl - z_star_95 * sigma/sqrt(50)
upper = mean_sampl + z_star_95 * sigma/sqrt(50)



sampl=sample_n(population,size = 200)
ggplot(sampl, aes(x = heightIn)) +
  stat_ecdf()



cal_ecdf=calc_dkw(sampl, column = "heightIn", alpha = 0.05)
cal_ecdf
cal_ecdf=cal_ecdf[2:201,]
ggplot() +
  stat_ecdf(data=heightweight, aes(x = heightIn),colour="#0072B2", linewidth=.7)+
  geom_step(data = cal_ecdf, aes (x=x,y=low)) +
  geom_step(data = cal_ecdf, aes (x=x,y=high))


mean_est=sum(sampl$heightIn)/length(sampl$heightIn)
mean_est
var_est <- sum((sampl$heightIn-mean_est)Ì‚ 2)/ length (sampl$heightIn)
var_est

